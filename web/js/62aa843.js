$().ready(function(){var d=window.location.pathname.split("/");var c=(d[1]=="app_dev.php")?"/app_dev.php":"";var a={autocomplete:null,init:function(e){var f=this;var e=$.extend({address:"South Africa"},e);var g=new google.maps.Geocoder();g.geocode(e,function(i,h){var l=i[0].address_components[0].short_name.toLowerCase();var m={types:["(cities)"],componentRestrictions:{country:l}};var k=document.getElementById("profile-google-place-search");google.maps.event.addDomListener(k,"keydown",function(n){if(n.keyCode==13){if(n.preventDefault){n.preventDefault()}else{n.cancelBubble=true;n.returnValue=false}}});(function j(n,o){var p=(n.addEventListener)?n.addEventListener:n.attachEvent;function q(r,s){if(r=="keydown"){var t=s;s=function(w){var u=$(".pac-item.pac-selected").length>0;if(w.which==13&&!u){var v=$.Event("keydown",{keyCode:40,which:40});t.apply(n,[v])}t.apply(n,[w])}}p.apply(n,[r,s])}n.addEventListener=q;n.attachEvent=q;f.autocomplete=new google.maps.places.Autocomplete(n,o);google.maps.event.addListener(f.autocomplete,"place_changed",function(){var r=f.autocomplete.getPlace()})})(k,m)})}};function b(){var f={};var g=function(){var h={};var i=null;$("#profile-country-search").autocomplete({minLength:2,source:function(m,j){var l=m.term;if(l in h){j(h[l]);return}var k=c+"/ajax/fetch-buggl-countries";if(i!=null){i.abort()}i=$.getJSON(k,m,function(o,n,p){h[l]=o;j(o)})},search:function(j,k){$("#profile-country-search").data("id",0)},select:function(j,k){if(k.item.id==0){$("#profile-country-search").val("");$("#profile-country-search").data("id",k.item.id);return false}e(k.item.label);$("#profile-country-search").data("id",k.item.id)}}).on("blur",function(j){if(typeof($(this).data("id"))=="undefined"||$(this).data("id")==0){$(this).val("");$("#profile-google-place-search").val("").unbind();return}if($(this).val().length>1){e($(this).val())}});if($("#profile-country-search").attr("data-id")!=undefined){$("#profile-country-search").data("id",$("#profile-country-search").attr("data-id"));$("#profile-country-search").removeAttr("data-id")}if($("#profile-country-search").val()!=undefined&&$("#profile-country-search").val().length>0){e($("#profile-country-search").val())}};var e=function(i){console.log("prepareLocation");if(a.autocomplete!=null){var h=new google.maps.Geocoder();h.geocode({address:i},function(k,j){var l=k[0].address_components[0].short_name.toLowerCase();a.autocomplete.setComponentRestrictions({country:l})})}else{a.init({address:i})}};return{init:function(h){g()}}}var b=new b();b.init()});